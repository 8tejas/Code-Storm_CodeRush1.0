<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CortiCare</title>
  <link rel="stylesheet" href="{{url_for('static', filename='loginpage.css')}}">
</head>
<body>
  <div class="container">
    <div id="app-title">CortiCare</div>

    <!-- Login Form -->
    <div id="login-form" class="form active">
      <h2>Login</h2>
      <div class="form-group">
        <label for="login-email">Email</label>
        <input type="email" id="login-email" placeholder="Enter email">
      </div>
      <div class="form-group">
        <label for="login-password">Password</label>
        <input type="password" id="login-password" placeholder="Enter password">
      </div>
      <button id="login-btn">Login</button>
      <div class="toggle-text">Donâ€™t have an account? 
        <span id="show-signup">Sign up</span>
      </div>
    </div>

    <!-- Signup Form -->
    <div id="signup-form" class="form">
      <h2>Sign Up</h2>
      <div class="form-group">
        <label for="signup-name">Full Name</label>
        <input type="text" id="signup-name" placeholder="Enter full name">
      </div>
      <div class="form-group">
        <label for="signup-email">Email</label>
        <input type="email" id="signup-email" placeholder="Enter email">
      </div>
      <div class="form-group">
        <label for="signup-password">Password</label>
        <input type="password" id="signup-password" placeholder="Enter password">
      </div>
      <button id="signup-btn">Sign Up</button>
      <div class="toggle-text">Already have an account? 
        <span id="show-login">Login</span>
      </div>
    </div>
  </div>

<script>
  // Toggle between login and signup
  const loginForm = document.getElementById("login-form");
  const signupForm = document.getElementById("signup-form");
  const showSignup = document.getElementById("show-signup");
  const showLogin = document.getElementById("show-login");

  showSignup.addEventListener("click", () => {
    loginForm.classList.remove("active");
    signupForm.classList.add("active");
  });

  showLogin.addEventListener("click", () => {
    signupForm.classList.remove("active");
    loginForm.classList.add("active");
  });

  // Signup handler
  document.getElementById("signup-btn").addEventListener("click", async () => {
    const name = document.getElementById("signup-name").value;
    const email = document.getElementById("signup-email").value;
    const password = document.getElementById("signup-password").value;

    const res = await fetch("/signup", {
      method: "POST",
      headers: {"Content-Type": "application/json"},
      body: JSON.stringify({name, email, password})
    });

    const data = await res.json();
    alert(data.message);
  });

  // Login handler with redirect
  document.getElementById("login-btn").addEventListener("click", async () => {
    const email = document.getElementById("login-email").value;
    const password = document.getElementById("login-password").value;

    const res = await fetch("/login", {
      method: "POST",
      headers: {"Content-Type": "application/json"},
      body: JSON.stringify({email, password})
    });

    const data = await res.json();

    if (res.ok && data.success) {
      // Redirect to /upload
      window.location.href = "/upload";
    } else {
      alert(data.message || "Login failed");
    }
  });
</script>

</body>
</html>
